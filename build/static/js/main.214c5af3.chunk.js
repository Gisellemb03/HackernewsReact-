(this["webpackJsonphackernews-react-apollo"]=this["webpackJsonphackernews-react-apollo"]||[]).push([[0],{86:function(e,n,t){},98:function(e,n,t){"use strict";t.r(n);var a=t(11),c=t(2),r=t(66),s=t.n(r),o=(t(86),t(20)),i=t(25),l=(t(110),"auth-token"),d=t(45),u=t(18),j=t(113);function b(e){return function(e,n){var t=6e4,a=36e5,c=864e5,r=2592e6,s=31536e6,o=e-n;return o<2e4?"just now":o<t?"less than 1 min ago":o<a?Math.round(o/t)+" min ago":o<c?Math.round(o/a)+" h ago":o<r?Math.round(o/c)+" days ago":o<s?Math.round(o/r)+" mo ago":Math.round(o/s)+" years ago"}((new Date).getTime(),new Date(e).getTime())}var m,h,p,O,g,x,v=t(3),f=Object(i.a)(m||(m=Object(o.a)(["\n  mutation createVote($linkId: Int!) {\n    createVote(linkId: $linkId) {\n      user {\n        username\n        email\n      }\n      link {\n        url\n        description\n      }\n    }\n  }\n"]))),w=function(e){var n=e.link,t=localStorage.getItem(l),c=Object(j.a)(f,{variables:{linkId:n.id},onCompleted:function(e){var n=e.createVote;console.log(n)},update:function(e,t){var c=t.data.vote,r=e.readQuery({query:k}).links.map((function(e){return e.id===n.id?Object(a.a)(Object(a.a)({},e),{},{votes:[].concat(Object(d.a)(e.votes.edges),[c])}):e}));e.writeQuery({query:k,data:{feed:{links:r}}})}}),r=Object(u.a)(c,1)[0];return Object(v.jsxs)("div",{className:"flex mt2 items-start",children:[Object(v.jsxs)("div",{className:"flex items-center",children:[Object(v.jsxs)("span",{className:"gray",children:[e.index+1,"."]}),t&&Object(v.jsx)("div",{className:"ml1 gray f11",style:{cursor:"pointer"},onClick:r,children:"\u25b2"})]}),Object(v.jsxs)("div",{className:"ml1",children:[Object(v.jsxs)("div",{children:[n.id," - ",n.description," (",n.url,")"]}),t&&Object(v.jsxs)("div",{className:"f6 lh-copy gray",children:[n.votes.edges.length," votes | by"," ",n.postedBy?n.postedBy.username:"Unknown"," ",b(Date().toLocaleString())]})]})]})},k=Object(i.a)(h||(h=Object(o.a)(["\n  {\n  links{\n    id\n    url\n    description\n    postedBy{\n      id\n      email\n      username\n    }\n    votes{\n      edges{\n        node{\n          id\n          link{\n            id\n            url\n            description\n          }\n        }\n      }\n    }\n  }\n}\n"]))),y=t(6),N=Object(i.a)(p||(p=Object(o.a)(["\n  mutation CreateLink(\n    $description: String!\n    $url: String!\n  ) {\n    createLink(description: $description, url: $url) {\n      id\n      url\n      description\n    }\n  }\n"]))),S=function(){var e=Object(y.g)(),n=Object(c.useState)({description:"",url:""}),t=Object(u.a)(n,2),r=t[0],s=t[1],o=Object(j.a)(N,{variables:{description:r.description,url:r.url},update:function(e,n){var t=n.data.post,a={createdAt:"desc"},c=e.readQuery({query:k,variables:{take:5,skip:0,orderBy:a}});e.writeQuery({query:k,data:{feed:{links:[t].concat(Object(d.a)(c.feed.links))}},variables:{take:5,skip:0,orderBy:a}})},onCompleted:function(){return e.push("/new/1")}}),i=Object(u.a)(o,1)[0];return Object(v.jsx)("div",{children:Object(v.jsxs)("form",{onSubmit:function(e){e.preventDefault(),i()},children:[Object(v.jsxs)("div",{className:"flex flex-column mt3",children:[Object(v.jsx)("input",{className:"mb2",value:r.description,onChange:function(e){return s(Object(a.a)(Object(a.a)({},r),{},{description:e.target.value}))},type:"text",placeholder:"A description for the link"}),Object(v.jsx)("input",{className:"mb2",value:r.url,onChange:function(e){return s(Object(a.a)(Object(a.a)({},r),{},{url:e.target.value}))},type:"text",placeholder:"The URL for the link"})]}),Object(v.jsx)("button",{type:"submit",onClick:function(){i(),e.push("/"),window.location.reload()},children:"Submit"})]})})},$=t(21),C=function(){var e=Object(y.g)(),n=localStorage.getItem(l);return Object(v.jsxs)("div",{className:"flex pa1 justify-between nowrap orange",children:[Object(v.jsxs)("div",{className:"flex flex-fixed white",children:[Object(v.jsx)("div",{className:"fw7 mr1",children:"GIMEBA NEWS"}),Object(v.jsx)($.b,{to:"/",className:"ml1 no-underline white",children:"new"}),Object(v.jsx)("div",{className:"ml1",children:"|"}),Object(v.jsx)($.b,{to:"/top",className:"ml1 no-underline white",children:"top"}),Object(v.jsx)("div",{className:"ml1",children:"|"}),Object(v.jsx)($.b,{to:"/search",className:"ml1 no-underline white",children:"search"}),n&&Object(v.jsxs)("div",{className:"flex",children:[Object(v.jsx)("div",{className:"ml1",children:"|"}),Object(v.jsx)($.b,{to:"/create",className:"ml1 no-underline white",children:"submit"})]})]}),Object(v.jsx)("div",{className:"flex flex-fixed",children:n?Object(v.jsx)("div",{className:"ml1 pointer white",onClick:function(){localStorage.removeItem(l),e.push("/")},children:"logout"}):Object(v.jsx)($.b,{to:"/login",className:"ml1 no-underline white",children:"login"})})]})},I=Object(i.a)(O||(O=Object(o.a)(["\nmutation SignupMutation(\n  $email: String!\n  $password: String!\n  $username: String!\n) {\n  createUser(\n    email: $email\n    password: $password\n    username: $username\n  ) {\n   user{\n    id\n    email\n    password\n    username\n  }\n  }\n\n \n\n  tokenAuth(username: $username,password: $password){\n  token\n  }\n}\n"]))),A=Object(i.a)(g||(g=Object(o.a)(["\n  mutation TokenAuth(\n    $username: String!\n    $password: String!\n  ) {\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  }\n"]))),B=function(){var e=Object(y.g)(),n=Object(c.useState)({login:!0,email:"",password:"",name:""}),t=Object(u.a)(n,2),r=t[0],s=t[1],o=Object(j.a)(A,{variables:{username:r.email,password:r.password},onCompleted:function(n){var t=n.tokenAuth;console.log(t),localStorage.setItem(l,t.token),e.push("/")}}),i=Object(u.a)(o,1)[0];var d=Object(j.a)(I,{variables:{username:r.name,email:r.email,password:r.password},onCompleted:function(n){var t=n.tokenAuth;localStorage.setItem(l,t.token),e.push("/")}}),b=Object(u.a)(d,1)[0];return Object(v.jsxs)("div",{children:[Object(v.jsx)("h4",{className:"mv3",children:r.login?"Login":"Sign Up"}),Object(v.jsxs)("div",{className:"flex flex-column",children:[!r.login&&Object(v.jsx)("input",{value:r.name,onChange:function(e){return s(Object(a.a)(Object(a.a)({},r),{},{name:e.target.value}))},type:"text",placeholder:"Your name"}),Object(v.jsx)("input",{value:r.email,onChange:function(e){return s(Object(a.a)(Object(a.a)({},r),{},{email:e.target.value}))},type:"text",placeholder:"Your name"}),Object(v.jsx)("input",{value:r.password,onChange:function(e){return s(Object(a.a)(Object(a.a)({},r),{},{password:e.target.value}))},type:"password",placeholder:"Choose a safe password"})]}),Object(v.jsxs)("div",{className:"flex mt3",children:[Object(v.jsx)("button",{className:"pointer mr2 button",onClick:function(){r.login?i(r.username,r.password).then((function(){window.location.reload()})):b(r.name,r.password)},children:r.login?"login":"create account"}),Object(v.jsx)("button",{className:"pointer button",onClick:function(e){return s(Object(a.a)(Object(a.a)({},r),{},{login:!r.login}))},children:r.login?"need to create an account?":"already have an account?"})]})]})},L=t(111),M=Object(i.a)(x||(x=Object(o.a)(["\n  query FeedSearchQuery($search: String) {\n  links(search: $search){\n      id\n      url\n        description\n        postedBy {\n          id\n          username\n        }\n        votes {\n          edges{\n            node{\n              id\n               user {\n                id\n            }\n            }\n          }\n\n \n\n        }\n       # createdAt\n  }\n}\n"]))),Q=function(){var e=Object(c.useState)(""),n=Object(u.a)(e,2),t=n[0],a=n[1],r=Object(L.a)(M),s=Object(u.a)(r,2),o=s[0],i=s[1].data;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{children:["Search",Object(v.jsx)("input",{type:"text",onChange:function(e){return a(e.target.value)}}),Object(v.jsx)("button",{onClick:function(){return o({variables:{search:t}})},children:"OK"})]}),i&&i.links.map((function(e,n){return Object(v.jsx)(w,{link:e,index:n},e.id)}))]})},q=function(){return Object(v.jsxs)("div",{className:"center w85",children:[Object(v.jsx)(C,{}),Object(v.jsx)("div",{className:"ph3 pv1 background-gray",children:Object(v.jsxs)(y.d,{children:[Object(v.jsx)(y.b,{exact:!0,path:"/",render:function(){return Object(v.jsx)(y.a,{to:"/new/1"})}}),Object(v.jsx)(y.b,{exact:!0,path:"/create",component:S}),Object(v.jsx)(y.b,{exact:!0,path:"/login",component:B}),Object(v.jsx)(y.b,{exact:!0,path:"/search",component:Q})]})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var E=t(71),T=t(72),D=t(73),U=t(51),W=t(27),J=t(99),V=t(97),F=Object(D.a)({uri:"http://35.232.232.192:8090/graphql/"}),G=Object(E.a)((function(e,n){var t=n.headers,c=localStorage.getItem(l);return{headers:Object(a.a)(Object(a.a)({},t),{},{authorization:c?"JWT ".concat(c):""})}})),Y=Object(T.a)((function(e){var n=e.graphQLErrors,t=e.networkError;n&&n.forEach((function(e){var n=e.message,t=e.locations,a=e.path;return console.log("[GraphQL error]: Message: ".concat(n,", Location: ").concat(t,", Path: ").concat(a))})),t&&console.log("[Network error]: ".concat(t))})),z=new U.a({link:Object(W.from)([G,Y,F]),cache:new J.a});s.a.render(Object(v.jsxs)($.a,{children:[Object(v.jsx)(V.a,{client:z,children:Object(v.jsx)(q,{})}),","]}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[98,1,2]]]);
//# sourceMappingURL=main.214c5af3.chunk.js.map