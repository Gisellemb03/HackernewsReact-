{"ast":null,"code":"import _objectSpread from\"/home/gimeba/hackernews-react-apollo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/gimeba/hackernews-react-apollo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/home/gimeba/hackernews-react-apollo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2;import React,{useState}from'react';import{useHistory}from'react-router';import{useMutation,gql}from'@apollo/client';import{AUTH_TOKEN}from'../constants';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SIGNUP_MUTATION=gql(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\nmutation SignupMutation(\\n  $email: String!\\n  $password: String!\\n  $username: String!\\n) {\\n  createUser(\\n    email: $email\\n    password: $password\\n    username: $username\\n  ) {\\n   user{\\n    id\\n    email\\n    password\\n    username\\n  }\\n  }\\n\\n \\n\\n  tokenAuth(username: $username,password: $password){\\n  token\\n  }\\n}\\n\"])));var LOGIN_MUTATION=gql(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  mutation TokenAuth(\\n    $username: String!\\n    $password: String!\\n  ) {\\n    tokenAuth(username: $username, password: $password) {\\n      token\\n    }\\n  }\\n\"])));var Login=function Login(){var history=useHistory();var _useState=useState({login:true,email:'',password:'',name:''}),_useState2=_slicedToArray(_useState,2),formState=_useState2[0],setFormState=_useState2[1];var _useMutation=useMutation(LOGIN_MUTATION,{variables:{username:formState.email,password:formState.password},onCompleted:function onCompleted(_ref){var tokenAuth=_ref.tokenAuth;console.log(tokenAuth);localStorage.setItem(AUTH_TOKEN,tokenAuth.token);history.push('/');}}),_useMutation2=_slicedToArray(_useMutation,1),login=_useMutation2[0];function refreshPage(){window.location.reload(true);}var _useMutation3=useMutation(SIGNUP_MUTATION,{variables:{username:formState.name,email:formState.email,password:formState.password},onCompleted:function onCompleted(_ref2){var tokenAuth=_ref2.tokenAuth;localStorage.setItem(AUTH_TOKEN,tokenAuth.token);history.push('/');}}),_useMutation4=_slicedToArray(_useMutation3,1),signup=_useMutation4[0];return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"mv3\",children:formState.login?'Login':'Sign Up'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-column\",children:[!formState.login&&/*#__PURE__*/_jsx(\"input\",{value:formState.name,onChange:function onChange(e){return setFormState(_objectSpread(_objectSpread({},formState),{},{name:e.target.value}));},type:\"text\",placeholder:\"Your name\"}),/*#__PURE__*/_jsx(\"input\",{value:formState.email,onChange:function onChange(e){return setFormState(_objectSpread(_objectSpread({},formState),{},{email:e.target.value}));},type:\"text\",placeholder:\"Your name\"}),/*#__PURE__*/_jsx(\"input\",{value:formState.password,onChange:function onChange(e){return setFormState(_objectSpread(_objectSpread({},formState),{},{password:e.target.value}));},type:\"password\",placeholder:\"Choose a safe password\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex mt3\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"pointer mr2 button\",onClick:function onClick(){//formState.login ? login : signup ()\nif(formState.login){login(formState.username,formState.password).then(function(){window.location.reload();});}else{signup(formState.name,formState.password);}},children:formState.login?'login':'create account'}),/*#__PURE__*/_jsx(\"button\",{className:\"pointer button\",onClick:function onClick(e){return setFormState(_objectSpread(_objectSpread({},formState),{},{login:!formState.login}));},children:formState.login?'need to create an account?':'already have an account?'})]})]});};export default Login;","map":{"version":3,"sources":["/home/gimeba/hackernews-react-apollo/src/components/Login.js"],"names":["React","useState","useHistory","useMutation","gql","AUTH_TOKEN","Link","SIGNUP_MUTATION","LOGIN_MUTATION","Login","history","login","email","password","name","formState","setFormState","variables","username","onCompleted","tokenAuth","console","log","localStorage","setItem","token","push","refreshPage","window","location","reload","signup","e","target","value","then"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useHistory } from 'react-router';\nimport { useMutation, gql } from '@apollo/client';\nimport { AUTH_TOKEN } from '../constants';\nimport { Link } from 'react-router-dom';\n\n \n\n\nconst SIGNUP_MUTATION = gql`\nmutation SignupMutation(\n  $email: String!\n  $password: String!\n  $username: String!\n) {\n  createUser(\n    email: $email\n    password: $password\n    username: $username\n  ) {\n   user{\n    id\n    email\n    password\n    username\n  }\n  }\n\n \n\n  tokenAuth(username: $username,password: $password){\n  token\n  }\n}\n`;\n\n \n\nconst LOGIN_MUTATION = gql`\n  mutation TokenAuth(\n    $username: String!\n    $password: String!\n  ) {\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  }\n`;\n\n \n\n \n\nconst Login = () => {\n  const history = useHistory();\n  const [formState, setFormState] = useState({\n    login: true,\n    email: '',\n    password: '',\n    name: ''\n  });\n\n \n\nconst [login] = useMutation(LOGIN_MUTATION, {\n  variables: {\n    username: formState.email,\n    password: formState.password\n  },\n  onCompleted: ({ tokenAuth }) => {\n    console.log(tokenAuth);\n    localStorage.setItem(AUTH_TOKEN, tokenAuth.token);\n    history.push('/');\n  }\n});\n\n \n\n\nfunction refreshPage(){\n  window.location.reload(true);\n}\n\n \n\nconst [signup] = useMutation(SIGNUP_MUTATION, {\n  variables: {\n    username: formState.name,\n    email: formState.email,\n    password: formState.password\n  },\n  onCompleted: ({ tokenAuth }) => {\n    localStorage.setItem(AUTH_TOKEN, tokenAuth.token);\n    history.push('/');\n\n \n\n  }\n});\n\n \n\n \n\n  return (\n    <div>\n      <h4 className=\"mv3\">\n        {formState.login ? 'Login' : 'Sign Up'}\n      </h4>\n      <div className=\"flex flex-column\">\n        {!formState.login && (\n          <input\n            value={formState.name}\n            onChange={(e) =>\n              setFormState({\n                ...formState,\n                name: e.target.value\n              })\n            }\n            type=\"text\"\n            placeholder=\"Your name\"\n          />\n        )}\n        <input\n          value={formState.email}\n          onChange={(e) =>\n            setFormState({\n              ...formState,\n              email: e.target.value\n            })\n          }\n          type=\"text\"\n          placeholder=\"Your name\"\n        />\n        <input\n          value={formState.password}\n          onChange={(e) =>\n            setFormState({\n              ...formState,\n              password: e.target.value\n            })\n          }\n          type=\"password\"\n          placeholder=\"Choose a safe password\"\n        />\n      </div>\n      <div className=\"flex mt3\">\n\n \n\n<button\n    className=\"pointer mr2 button\"\n    onClick={() => {\n      //formState.login ? login : signup ()\n      if (formState.login ) {\n        login(formState.username, formState.password ).then(()=>{\n          window.location.reload()\n\n \n\n        })\n\n \n\n      } else {\n        signup(formState.name, formState.password)\n      }\n    }}\n  >\n    {formState.login ? 'login' : 'create account' }\n\n \n\n\n  </button >\n  <button\n    className=\"pointer button\"\n    onClick={(e) =>\n      setFormState({\n        ...formState,\n        login: !formState.login\n      })\n    }\n  >\n          {formState.login\n            ? 'need to create an account?'\n            : 'already have an account?'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\n \n\nexport default Login;"]},"metadata":{},"sourceType":"module"}